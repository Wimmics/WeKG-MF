#query average temperature between 02 august and 8 august
PREFIX sosa: <http://www.w3.org/ns/sosa/>
PREFIX qudt: <http://qudt.org/schema/qudt/>
PREFIX wep: <http://ns.inria.fr/meteo/ontology/property/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX weo: <http://ns.inria.fr/meteo/ontology/>


select ?stationID  ?n ((avg(?v)- 273.15) as ?avgws)   where {
  ?obs a  <http://ns.inria.fr/meteo/ontology/MeteorologicalObservation>; 
sosa:observedProperty
              <http://ns.inria.fr/meteo/vocab/weatherproperty/airTemperature> ;
sosa:hasResult [ qudt:numericValue ?v]; 
wep:madeByStation ?station ;
sosa:resultTime ?t .
FILTER (?jour >= 2 && ?jour < (?jour +7))
BIND (day(?t) AS ?jour) 
?station rdfs:label ?n ; weo:stationID ?stationID
}
GROUP BY ?stationID ?n
ORDER BY ?avgws
